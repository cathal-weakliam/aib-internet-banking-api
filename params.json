{"name":"AIB Online Banking API","tagline":"A screen scraped API for AIB Internet Banking","body":"###AIB Online Banking API\r\nI wanted to be able to access my bank account information from various sources, \r\nso I created this screenscraping API for AIB Online Banking. \r\n\r\nThis version (v2) is the newer version of AIB Online banking (2015). To use the older\r\nversion, checkout branch (online-banking-v1).\r\n\r\n###Implementation\r\nScreenscraping a banking website requires very accurate imitation of a real \r\nuser using a browser. User-Agents are important. The sequence of links you navigate \r\nto get to certain information is important. Every link has a one-time-only CSRF token \r\nattached that must be used only when clicking that link. \r\n\r\nTo achieve this with the AIB Online Banking site, my strategy is to always bring the \r\nbrowsing session back to a \"home\" page and store that page HTML in a datastore \r\n(currently [MapDB](http://www.mapdb.org/), for no particular reason. You can replace this with your own \r\nimplementation of a `StorageService` if you prefer - there's a sample Cassandra implementation\r\nincluded too). As each API call comes through, I navigate from this known state to the pages required and then \r\nback to the home page. This makes some API calls a bit slower than you would desire, but \r\nit's easier than trying to maintain a state engine that knows where you are and how to get \r\nthe desired page from there all the time. \r\n\r\n### Authentication\r\nOnce you interact with the site initially it assigns a `JSESSIONID` cookie that must be \r\nmaintained for the rest of the session. I store this in the datastore with the page contents, \r\nand create a completely independent UUID Session ID for the API to use. This keeps your actual \r\nsession ID secret which is good for security reasons. \r\n\r\nThe API Session ID is returned from the first API call `/v2/login/registration` and must be sent \r\nas a query string parameter to all subsequent API calls. E.g.\r\n\r\n```\r\nPOST /v2/login/pac?sessionId=517215a0-8c6a-11e3-97ac-001422f0bc99\r\n```\r\n\r\n### API\r\nAll API endpoints accept Form Encoded data and return JSON.\r\n\r\n#### Logging In - Step 1\r\n\r\n| method | path                    |\r\n|--------|-------------------------|\r\n| POST   | /v2/login/registration  |\r\n\r\n##### Payload\r\n\r\n| name               \t| description                             | example value                       |\r\n|-----------------------|-----------------------------------------|-------------------------------------|\r\n| REGISTRATION_NUMBER   | Your AIB Online Banking Reg Number \t  | 12345678                           \t|\t\r\n\r\n##### Example\r\n\r\n```bash\r\n$ curl --data \"REGISTRATION_NUMBER=12345678\" $API_BASE/v2/login/registration\r\n```\r\n\r\n```json\r\n{\r\n    \"sessionId\": \"517215a0-8c6a-11e3-97ac-001422f0bc99\",\r\n    \"digit2\": \"3\",\r\n    \"digit1\": \"2\",\r\n    \"digit3\": \"5\"\r\n}\r\n```\r\n\r\n##### Properties\r\n\r\n| name         \t\t| description                                                                   | example value         |\r\n|-------------------|-------------------------------------------------------------------------------|-----------------------|\r\n| sessionId     \t| The API Session ID for use in subsequent calls    \t\t\t\t\t\t\t| {GUID}                |\r\n| digit1, 2, and 3  | Which three digits of your PAC is it looking for.                             | 1,2,3,4 or 5     \t\t|\r\n\r\n#### Logging In - Step 2\r\n\r\n| method | path                    |\r\n|--------|-------------------------|\r\n| POST   | /v2/login/pac \t\t   |\r\n\r\n##### Payload\r\n\r\n| name  \t| description             \t\t\t\t\t\t\t                | example value |\r\n|-----------|-------------------------------------------------------------------|---------------|\r\n| DIGITS  \t| The Challenge digits requested, e.g. of your home phone number    | 1234          |\r\n| PAC1,2,3  | The PAC digits requested. `PAC1` is the first digit requested specified in `digit1` from the previous response, not the first digit of your PAC.    | 0-9     |\r\n\r\n##### Example\r\n\r\n```bash\r\n$ curl --data \"PAC1=2&PAC2=3&PAC3=1\" $API_BASE/v2/login/pac?sessionId=517215a0-8c6a-11e3-97ac-001422f0bc99\r\n\r\n```\r\n\r\n```json\r\n{\r\n    \"balances\": \r\n        [{\r\n            \"id\": 0,\r\n            \"name\": \"SAVINGS-123\",\r\n            \"balance\": 1085.42,\r\n            \"drcr\": \"\",\r\n            \"transactions\": null,\r\n            \"pending\": false,\r\n            \"dr\": false\r\n        }]\r\n}\r\n```\r\n\r\n##### Properties\r\nThe login step returns your list of accounts and their balances.\r\n\r\n| name         \t| description                               \t\t\t\t\t\t\t    | example value |\r\n|---------------|---------------------------------------------------------------------------|---------------|\r\n| id\t\t\t| The ID given to the account in the account list by AIB Online Banking. Doesn't always keep this ID in other situations. | 0 |\r\n| name       \t| Name of the account as in AIB Online Banking \t\t\t\t\t\t\t\t| \"SAVINGS-123\" |\r\n| balance     \t| BigDecimal balance of the account\t\t\t\t\t\t\t\t\t\t\t| 100.00   \t\t|\r\n| drcr  \t\t| String indication of the debit/credit status of the account. \t\t\t\t| \"DR\" \t\t\t|\r\n| transactions \t| Can't remember what this is for right now, seems to be null all the time! | null \t\t\t|\r\n| pending \t\t| Whether or not this account can have pending transactions. \t\t\t\t| true \t\t\t| \r\n| dr \t\t\t| Boolean indicating the debit or credit status of the balance. \t\t\t| true \t\t\t|\r\n\r\n#### List accounts and balances\r\nGives the same response as Login - Step 2 above.\r\n\r\n| method | path                     |\r\n|--------|--------------------------|\r\n| GET    | /v2/accounts/balances    |\r\n\r\n##### Payload\r\n\r\nNone\r\n\r\n##### Example\r\n\r\n```bash\r\n$ curl $API_BASE/v2/accounts/balances?sessionId=517215a0-8c6a-11e3-97ac-001422f0bc99\r\n\r\n```\r\n\r\n```json\r\n{\r\n    \"balances\": \r\n        [{\r\n            \"id\": 0,\r\n            \"name\": \"SAVINGS-123\",\r\n            \"balance\": 1085.42,\r\n            \"drcr\": \"\",\r\n            \"transactions\": null,\r\n            \"pending\": false,\r\n            \"dr\": false\r\n        }]\r\n}\r\n```\r\n\r\n##### Properties\r\nReturns your list of accounts and their balances.\r\n\r\n| name         \t| description                               \t\t\t\t\t\t\t    | example value |\r\n|---------------|---------------------------------------------------------------------------|---------------|\r\n| id\t\t\t| The ID given to the account in the account list by AIB Online Banking. Doesn't always keep this ID in other situations. | 0 |\r\n| name       \t| Name of the account as in AIB Online Banking \t\t\t\t\t\t\t\t| \"SAVINGS-123\" |\r\n| balance     \t| BigDecimal balance of the account\t\t\t\t\t\t\t\t\t\t\t| 100.00   \t\t|\r\n| drcr  \t\t| String indication of the debit/credit status of the account. \t\t\t\t| \"DR\" \t\t\t|\r\n| transactions \t| Can't remember what this is for right now, seems to be null all the time! | null \t\t\t|\r\n| pending \t\t| Whether or not this account can have pending transactions. \t\t\t\t| true \t\t\t| \r\n| dr \t\t\t| Boolean indicating the debit or credit status of the balance. \t\t\t| true \t\t\t|\r\n\r\n#### List Transactions for account\r\n\r\n| method | path                    \t\t\t\t\t  |\r\n|--------|--------------------------------------------|\r\n| GET    | /v2/accounts/{accountName}/transactions    |\r\n\r\n##### Payload\r\n\r\nNone\r\n\r\n##### Example\r\n\r\n```bash\r\n$ curl $API_BASE/v2/accounts/SAVINGS-123/transactions?sessionId=517215a0-8c6a-11e3-97ac-001422f0bc99\r\n\r\n```\r\n\r\n```json\r\n{\r\n\t\"transactions\": {\r\n\t\t\"transactions\": [\r\n\t\t\t{\r\n\t\t\t\t\"transDate\": 1379286000000,\r\n\t\t\t\t\"narrative\": \"INTEREST CHARGED\",\r\n\t\t\t\t\"subNarrative\": \"(Incl. Surcharge- / Interest 0.00)\",\r\n\t\t\t\t\"amount\": \"195.86\",\r\n\t\t\t\t\"isDR\": true,\r\n\t\t\t\t\"subsequentBalance\": \"\"\r\n\t\t\t}\r\n\t\t]\r\n\t}\r\n}\r\n```\r\n\r\n##### Properties\r\nReturns the list of transactions for account `accountName`. Not sure why it's wrapped in two `transactions` elements....\r\n\r\n| name           \t| description                               \t\t\t\t\t\t\t    | example value\t\t\t|\r\n|-------------------|---------------------------------------------------------------------------|-----------------------|\r\n| transDate\t\t\t| Transaction date in milliseconds since the epoch. Rounded to nearest day. | 1379286000000 \t\t|\r\n| narrative       \t| The primary narrative of the transaction.    \t\t\t\t\t\t    \t| \"INTEREST CHARGED\"\t|\r\n| subNarrative     \t| All other sub-lines of information relating to this transaction \t\t\t| \"(Incl Surcharge)\t\t|\r\n| amount  \t\t    | The amount of the transaction.\t\t\t\t\t\t\t\t\t\t\t| \"29.23\" \t\t\t\t|\r\n| isDR \t\t\t    | Boolean indicating the debit or credit status of the transaction \t\t\t| true \t\t\t\t\t|\r\n| subsequentBalance | The balance after this transaction\t\t\t\t\t\t\t\t\t\t| \"343.23 \t\t\t\t|\r\n\r\n\r\n#### List Pending Transactions for account\r\nFor accounts marked as pending in the response from `/v2/accounts/balances` you can retrieve all pending transactions \r\nusing this endpoint.\r\n\r\n| method | path                    \t\t\t\t\t  |\r\n|--------|--------------------------------------------|\r\n| GET    | /v2/accounts/{accountName}/pending         |\r\n\r\n##### Payload\r\n\r\nNone\r\n\r\n##### Example\r\n\r\n```bash\r\n$ curl $API_BASE/v2/accounts/CURRENT-123/pending?sessionId=517215a0-8c6a-11e3-97ac-001422f0bc99\r\n```\r\n\r\n```json\r\n[\r\n\t{\r\n\t\t\"narrative\": \"MYMILKMAN\", \r\n\t\t\"amount\": \"14.00\",\r\n\t\t\"account\": \"CURRENT-358\",\r\n\t\t\"isDR\": true\r\n\t}\r\n]\r\n```\r\n\r\n##### Properties\r\nReturns the list of pending transactions for account `accountName`.\r\n\r\n| name           \t| description                               \t\t\t\t\t\t\t    | example value\t\t\t|\r\n|-------------------|---------------------------------------------------------------------------|-----------------------|\r\n| narrative       \t| The primary narrative of the transaction.    \t\t\t\t\t\t    \t| \"MYMILKMAN\"\t\t\t|\r\n| account  \t\t    | Rather pointless repeat of the account name :-/\t\t\t\t\t\t\t| \"CURRENT-123\" \t\t|\r\n| amount  \t\t    | The amount of the transaction.\t\t\t\t\t\t\t\t\t\t\t| \"29.23\" \t\t\t\t|\r\n| isDR \t\t\t    | Boolean indicating the debit or credit status of the transaction \t\t\t| true \t\t\t\t\t|\r\n\r\n\r\n#### Transfer between your own accounts\r\nThis is fairly experimental still - as there's a need for a digit of the PIN the first\r\ntime you transfer in a session, I need all the PIN digits. Alternatively I could \r\nturn this into a two-step API call like the login...\r\n\r\n| method | path                    \t\t\t\t\t  \t\t\t\t |\r\n|--------|-----------------------------------------------------------|\r\n| POST   | /v2/accounts/{accountNameFrom}/transferTo/{accountNameTo} |\r\n\r\n##### Payload\r\n\r\n| name  \t| description             \t\t\t\t\t\t\t                 | example value |\r\n|-----------|--------------------------------------------------------------------|---------------|\r\n| narrativeFrom  | The description to appear on the source account statement. Will be truncated to 12 chars.   | \"From me\"  |\r\n| narrativeTo | The description to appear on the destination account statement. Will be truncated to 18 chars. | \"To you\"  |\r\n| pinDigits | All your PIN Digits as a 5-digit number. This isn't the best idea! | 12345         |\r\n| amount | The amount to transfer \t\t\t\t\t\t\t\t\t\t\t\t | 50.00 \t\t |\r\n\r\n##### Example\r\n\r\n```bash\r\n$ curl -d \"narrativeFrom=From me&narrativeTo=to you&amount=20&pinDigits=12345\" \\\r\n\t\t$API_BASE/v2/accounts/CURRENT-123/transferTo/SAVINGS-234?sessionId=517215a0-8c6a-11e3-97ac-001422f0bc99\r\n```\r\n\r\n```json\r\n{}\r\n```\r\n\r\n##### Properties\r\n\r\nNone\r\n\r\n#### Logging Out\r\n\r\n| method | path                    |\r\n|--------|-------------------------|\r\n| GET    | /v2/logout              |\r\n\r\n##### Payload\r\n\r\nNone\r\n\r\n##### Example\r\n\r\n```bash\r\n$ curl $API_BASE/v2/logout?sessionId=517215a0-8c6a-11e3-97ac-001422f0bc99\r\n```\r\n\r\n```json\r\n{}\r\n```\r\n\r\n-------------------------\r\n![githalytics.com alpha](https://cruel-carlota.pagodabox.com/86752651125cd250b51190c2d3295a88 \"githalytics.com\")\r\n\r\n","google":"UA-48715419-2","note":"Don't delete this file! It's used internally to help with page regeneration."}